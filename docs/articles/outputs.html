<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>outputs • aurora</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="outputs">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">aurora</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/get_bags.html">get_bags</a></li>
    <li><a class="dropdown-item" href="../articles/outputs.html">outputs</a></li>
    <li><a class="dropdown-item" href="../articles/panGWAS.html">panGWAS</a></li>
    <li><a class="dropdown-item" href="../articles/panGWAS_with_large_dataset.html">panGWAS_with_large_dataset</a></li>
    <li><a class="dropdown-item" href="../articles/setup_conda.html">setup_conda</a></li>
    <li><a class="dropdown-item" href="../articles/SNP_and_kmer_GWAS.html">SNP_and_kmer_GWAS</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DalimilBujdos/aurora/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>outputs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DalimilBujdos/aurora/blob/HEAD/vignettes/outputs.Rmd" class="external-link"><code>vignettes/outputs.Rmd</code></a></small>
      <div class="d-none name"><code>outputs.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a>
</h3>
<p>This article details all outputs from two main functions of the
<em>aurora</em> package <code><a href="../reference/aurora_pheno.html">aurora_pheno()</a></code> and
<code><a href="../reference/aurora_GWAS.html">aurora_GWAS()</a></code> and a minor function <code><a href="../reference/get_bags.html">get_bags()</a></code>.
The output from both functions depends on what parameters were used and
thus not all objects showed here may be part of your output.
Additionally, some output objects are not stored as R objects but are
simply saved to a directory that is specified in the function call with
an argument <code>save_dir</code>.</p>
</div>
<div class="section level3">
<h3 id="outputs-of-function-aurora_pheno">Outputs of function <code>aurora_pheno()</code><a class="anchor" aria-label="anchor" href="#outputs-of-function-aurora_pheno"></a>
</h3>
<p><code>call</code>: <code><a href="../reference/aurora_pheno.html">aurora_pheno()</a></code> function call with all
used arguments.</p>
<p><code>bin_mat</code>: The supplied binary matrix before any
filtering.</p>
<p><code>phenotypes</code>: All analysed phenotype classes.</p>
<p>#If Random Forest was used</p>
<p><code>$results$results_random_forest$p_val_mat</code>: Matrix that
shows results of pairwise Kolmogorov-Smirnov tests. This matrix is used
to indicate if the species has evolved adaptation strategy towards
phenotype classes. If both p-values (Class_A vs Class_B, Class_B vs
Class_A) are above 0.05 then the two classes should be considered
indistinguishable. This has no effect on subsequent run on
<code><a href="../reference/aurora_GWAS.html">aurora_GWAS()</a></code>. If any two classes are indistinguishable
then <code><a href="../reference/aurora_GWAS.html">aurora_GWAS()</a></code> prints only a warning and proceeds to
remove mislabeled strains rather then all strains from the two
classes.</p>
<p><code>$results$results_random_forest$auto_allo_results</code>: This
data frame contains the raw results of <code><a href="../reference/aurora_pheno.html">aurora_pheno()</a></code>. It
shows the predicted and observed phenotype class for each strain. It
also shows a detailed breakdown of each strains adaptation capability.
There are four possible labels that characterize adaptation of a strain
to a class: FALSE, TRUE, TRUE not typical and INCONCLUSIVE. FALSE simply
states that the strain is not adapted to the class. TRUE shows the
opposite. TRUE not typical points out that the strain may be adapted to
the class but likely does not possess some key adaptation factors (i.e.,
weakly autochthonous strain). INCONCLUSIVE then states that neither of
the previous labels could be identified. If the predicted phenotype
class is not the same as the observed then <code><a href="../reference/aurora_GWAS.html">aurora_GWAS()</a></code>
removes these strains.</p>
<p><code>$results$results_random_forest$plot</code>: Plot showing a
percentage distribution of <code>auto_allo_results</code>.</p>
<p><code>$results$results_random_forest$distance_heatmap_median</code>:
Pairwise distance matrix containing Random Forest proximities calculated
from Random forest models constructed in Outlier Calculation Phase. The
final value is a median of all the proximities. This matrix is clustered
and saved as <code>aurora_heatmap_median_random_forest_[date]</code> if
<code>write_data</code> is set to <code>TRUE</code> and
<code>save_dir</code> provided.</p>
<p><code>$results$results_random_forest$distance_heatmap_sum</code>:
Same as above but the final value is a sum of all the proximities. This
matrix is clustered and saved as
<code>aurora_heatmap_sum_random_forest_[date]</code> if
<code>write_data</code> is set to <code>TRUE</code> and
<code>save_dir</code> provided.</p>
<p><code>$results$results_random_forest$legend_heatmap</code>: Legend
describing row and column colors in
<code>aurora_heatmap_median_random_forest_[date]</code>
and<code>aurora_heatmap_sum_random_forest_[date]</code>.</p>
<p><code>$results$results_random_forest$gfs_importance</code>: This data
frame shows the feature importances calculated from Random Forest models
constructed in Outlier Calculation Phase.
<code>MeanDecreaseAccuracy_median</code> indicates the median of
MeanDecreaseAccuracy values, likewise MeanDecreaseGini_median shows mean
of all MeanDecreaseGini. See
<code>randomForest::randomForest::randomForest()</code> for more
information about these values. The subsequent columns show the presence
pattern of the feature in all phenotype classes in this format: the
feature is present|all strains in the class.</p>
<p><code>$results$results_random_forest$aucs</code>: Area under
receiver-operating characteristic curve (ROC curve) for all Random
Forest models constructed in Outlier Calculation Phase.</p>
<p>#If AdaBoost was used</p>
<p><code>$results$results_adaboost$p_val_mat</code>: Same as
<code>$results$results_random_forest$p_val_mat</code> above.</p>
<p><code>$results$results_adaboost$auto_allo_results</code>: Same as
<code>$results$results_random_forest$auto_allo_results</code> above.</p>
<p><code>$results$results_adaboost$plot</code>: Same as
<code>$results$results_random_forest$plot</code> above.</p>
<p><code>$results$results_adaboost$gfs_importance</code>: Same as
<code>$results$results_random_forest$gfs_importance</code> above. See <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.AdaBoostClassifier.html" class="external-link">AdaBoost
documentation</a> to find more information about AdaBoost feature
importances.</p>
<p><code>$results$results_adaboost$aucs</code>: Same as
<code>$results$results_random_forest$aucs</code> above.</p>
<p>#If Log regression was used</p>
<p><code>$results$results_log_reg$p_val_mat</code>: Same as
<code>$results$results_random_forest$p_val_mat</code> above.</p>
<p><code>$results$results_log_reg$auto_allo_results</code>: Same as
<code>$results$results_random_forest$auto_allo_results</code> above.</p>
<p><code>$results$results_log_reg$plot</code>: Same as
<code>$results$results_random_forest$plot</code> above.</p>
<p><code>$results$results_log_reg$gfs_importance</code>: Same as
<code>$results$results_random_forest$gfs_importance</code> above. See <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html" class="external-link">Log
regression documentation</a> to find more information about Log
regression feature importances.</p>
<p><code>$results$results_log_reg$aucs</code>: Same as
<code>$results$results_random_forest$aucs</code> above.</p>
<p>#If CARTx was used</p>
<p><code>$results$results_CART$p_val_mat</code>: Same as
<code>$results$results_random_forest$p_val_mat</code> above.</p>
<p><code>$results$results_CART$auto_allo_results</code>: Same as
<code>$results$results_random_forest$auto_allo_results</code> above.</p>
<p><code>$results$results_CART$plot</code>: Same as
<code>$results$results_random_forest$plot</code> above.</p>
<p><code>$results$results_CART$gfs_importance</code>: Same as
<code>$results$results_random_forest$gfs_importance</code> above.
Feature importances in CART models are sum of the goodness of split
measures for each split in the tree. See <a href="https://cran.r-project.org/web/packages/rpart/vignettes/" class="external-link">rpart
vignettes</a> to find more information about CART feature
importances.</p>
<p><code>$results$results_CART$aucs</code>: Same as
<code>$results$results_random_forest$aucs</code> above.</p>
<p><code>$results$results_CART$distance_heatmap</code>: Pairwise
distance matrix containing CART proximities calculated from CART models
constructed in Outlier Calculation Phase. The proximity calculation is
described in Figure S5 in the <em>aurora</em> article. This matrix is
clustered and saved as <code>aurora_heatmap_CART_[date]</code> if
<code>write_data</code> is set to <code>TRUE</code> and
<code>save_dir</code> provided.</p>
<p><code>$results$results_CART$legend_heatmap</code>: Legend describing
row and column colors in <code>aurora_heatmap_CART_[date]</code>
<code>$results$results_CART$complexity</code>: This data frame shows the
AUC for every pair of phenotype classes as well as the most common,
maximum and minimal number of splits (features) used to classify the two
classes. Higher values indicate that the two classes are difficult to
separate.</p>
</div>
<div class="section level3">
<h3 id="outputs-of-function-aurora_gwas">Outputs of function <code>aurora_GWAS()</code><a class="anchor" aria-label="anchor" href="#outputs-of-function-aurora_gwas"></a>
</h3>
<p><code>GWAS_results</code>: This data frame is the main output of the
function. If Panaroo/Roary/PIRATE were used as an imput then the second
column will contain the annotations. The next columns show the frequency
of the variants in the phenotype categories. Next column contains
p-values from chi-square test for each variant. Keep in min that the
lowest possible p-value is 0.0005. These values do not serve as a
genotype-phenotype association metric especially not when multiple
phenotype classes are analysed. Next, four values for each phenotypic
class are calculated; F1 Score: harmonic mean of precision and recall,
Recall: true positive rate, Precision: accuracy of positive predictions,
Standardized Residuals: Deviation from expected value. Only F1 Score and
Standardized Residuals should be used as association metrics. See
<code>panGWAS</code> vignette for more information of how to post
process these values.</p>
<p><code>removed_strains</code>: Data frame that indicates which strains
were removed prior to GWAS analysis.</p>
<p><code>bagging_results</code>: Data frame that shows how many times
each strain was sampled by either <code>phylogenetic_walk</code> or
<code>random_walk</code>.</p>
</div>
<div class="section level2">
<h2 id="if-other-mgwas-tools-are-used">If other mGWAS tools are used<a class="anchor" aria-label="anchor" href="#if-other-mgwas-tools-are-used"></a>
</h2>
<p>If results from <code><a href="../reference/aurora_pheno.html">aurora_pheno()</a></code> are provided then prior
to running any of these tools the mislabeled strains are removed.
Otherwise not strains are removed.</p>
<p><code>results_hogwash</code>: Result from running <a href="https://github.com/katiesaund/hogwash" class="external-link">Hogwash</a>.</p>
<p><code>result_treeWAS</code>: Raw results from running <a href="https://github.com/caitiecollins/treeWAS" class="external-link">TreeWAS</a>.</p>
<p><code>result_treeWAS_ordered</code>: Ordered results from running
TreeWAS. The p-values are converted to standard scale.</p>
<p>If <code>write_data</code> is set to <code>TRUE</code> and
<code>save_dir</code> provided then the TreeWAS results are also written
<code>treeWAS_results_[date]</code>. If requested then binary matrices,
phylogenetic trees and phenotypic matrices are written for <a href="https://github.com/AdmiralenOla/Scoary" class="external-link">Scoary</a> and <a href="https://github.com/mgalardini/pyseer" class="external-link">Pyseer</a>. These files are
correctly formatted can be used to run these tools.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dalimil Bujdoš.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
